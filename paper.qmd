---
title: "Preparing for Potential Closure of European Airspaces due to Re-entering Space Objects"

filters:
  - acronyms
  - highlight-text
  - abstract-section

format:
  ieee-pdf:
    keep-tex: true
    # fig-pos: 'H'
    journaltype: conference
    papersize: a4
    include-in-header:
      - file: media/preamble.tex
    include-before-body:
      - text: |
          % NOTE: make siunitx's \qty work without clashing with the one in physics
          \let\qty\SI
  ieee-html: 
    html-math-method: mathjax
    include-in-header:
      file: media/siunitx.html

author:
  - id: es
    name: Enrico Spinielli
    affiliations:
      - ref: aiu
    orcid: 0000-0001-8584-9131
    email: enrico.spinielli@eurocontrol.int
    attributes:
      corresponding: true
  - name: Rainer Koelle
    affiliations: 
      - ref: aiu
  - name: Quinten Goens
    affiliations: 
      - ref: aiu
affiliations:
  - id: aiu
    name: EUROCONTROL
    department: Aviation Intelligence Unit
    city: Brussels
    country: Belgium

bibliography: media/references.bib

acronyms:
  insert_loa: false
  fromfile:
    - ./media/acronyms.yml

---

# Abstract
The risk of collision of re-entering space debris with aircraft is 
increasing due to both increasing number of airborne flights and 
re-entries. National and international authorities need to balance
safety and economic impact of adopted measures.  
We asses airspaces density as flown by commercial airlines
distinguishing seasonal and hourly patterns.
We base our hourly density estimation on (enhanced) flown trajectories as
recorded by EUROCONTROL's \acr{NM} binned over Uber's H3
gridding system. Impact risk probabilities will then calculated based on work
from [@patera2008].
This combined with a buffered area along the the path of re-entry,
can provide risk impact probabilities for deciding on safety measure such as
airspace closures and/or re-routings.

# Introduction

We base our hourly flight density estimation on trajectories flown
by \acr{IFR} commercial aircraft as
recorded by EUROCONTROL's \acr{NM}[^1] and overlapped on Uber's H3
gridding system at different resolutions [@h3resolutions].
@fig-cells shows cells for resolution $2$ which corresponds to hexagons
of average area $\qty{86801.78}{km^2}$ and average edge length of 
$\qty{182.51}{km}$, see also @tbl-resolutions for other resolutions.

```{r}
#| label: tbl-resolutions
#| tbl-cap: H3 hexagons, average values
#| tbl-cap-location: bottom

library(tidyverse)
library(gt)
library(gtExtras)

tribble(
  ~resolution, ~hex_area, ~hex_edge,
  2L , 86801.780398997, 182.5129565,
  3L,  12393.434655088,  68.97922179,
  4L,   1770.347654491,  26.07175968
) |> 
  gt() |> 
   cols_label(
    resolution ~ "Resolution",
    hex_area ~ md("Cell Area"),
    hex_edge ~ md("Edge length")
  ) |> 
    gt::tab_header(
    title = md("H3 Cell Statistics"),
    subtitle = md("average hexagons")
  ) |> 
  cols_units(
    hex_area = "km^2",
    hex_edge = "km"
  ) |>
  opt_align_table_header(align = "left")
```



::: {#fig-cells}

```{r cells-map}
#| out-width: "100%"
#| echo: false
#| fig-scap: "H3 cells at resolution 2"
knitr::include_graphics("media/figures/cells_2.png")
```

H3 cells (red) at resolution 2 and their centers (blue) covering EUROCONTROL Area.
:::


We characterise densities on an hourly basis for representative days
in summer and winter.[^2]


We expand on the works of [@wrightAirspaceClosuresDue2025; @patera2008; @ailorLargeConstellationDisposal2020] and
provide a reproducible example for States, Agencies or relevant authorities
to build upon.

[^1]: NM coordinates \acr{ATFCM} operations on behalf of EUROCONTROL's 42 Member States
and 2 Comprehensive Member States covering
almost all \acr{ECAC} States.

[^2]: We will consider representative days in \acr{IATA} summer 2024 
and winter 2025 season.



@fig-density-winter-res-3 provides a promising result in the hourly flight
density calculation which at least shows
expected outcomes such as cells at zero density for war or no-fly zones such as
Ukraine, Libia or Syria.

::: {#fig-density-winter-res-3}

```{r density-winter-res-3}
#| out-width: "110%"
#| echo: false
knitr::include_graphics("media/figures/flight_density_2024-08-01T12_3.png")
```

Flight density in the EUROCONTROL Area on 2024-08-01T12 (H3 cells at resolution $3$).
:::



# Method

We follow the same mathematical approach of [@patera2008].
The probability, $p_k$, of a debris object $k$, impacting an aircraft over the
area, $a$, is expressed as:

$$
p_k = \varepsilon_k \int_a \rho(\vec{x}) \sigma(\vec{x}) da
$$ {#eq-impact-probability}

where $\rho({\vec{x}})$ is the probability density of an aircraft in $\vec{x}$,
$\sigma(\vec{x})$ is impact probability density of a debris object in the
position $\vec{x}$ and $\varepsilon_k$ is the effective expose area.

We can compute this probability for each hexagonal cell summing up for every
group of same aircraft type (so with same $\varepsilon_k$).


## Impact probability density

Debris that reenter the Earth’s atmosphere via drag-induced decay will fly
circular orbits prior to reentry even if initially on elliptical ones.
In fact drag at perigee will lower apogee and similarly drag at apogee will
lower perigee. But because drag at perigee is higher due to denser atmosphere,
the apogee  will decrease faster than perigee and the orbit will then tend to be
a circular one.
The angular position of the reentry point from the ascending node, 
see @sec-orbitals, is uniformly distributed, $\sigma(\theta) = 1 / (2\pi)$,
due to uncertainties in atmospheric drag and the gravitational effects of
the Equatorial bulge, hence we assume that the impact longitude, $\lambda$,
is uniformely distributed $\sigma(\lambda) = 1/(2\pi)$.

The impact probability density, $\sigma(\varphi, i)$,
at latitude $\varphi$ of a reentring object whose orbit has inclination $i$
(see @fig-orbital-elements) is given by [[Equation 15 in @patera2008]]:

$$ \sigma(\varphi, i) = \frac{1}{2 \pi^2 R^2 \sqrt{(\sin^2(i) - \sin^2(\varphi))}}$$ {#eq-impact-probability-density}

So for example if a building is located at latitude 30 degrees
north (or south) and has an area of $\qty{1000}{m^2}$ and a piece of debris
reenters the Earth’s atmosphere from an orbit having an inclination of 45 degrees,
the impact probability is given by

$$\begin{aligned}
P &= \Delta A \times \sigma(\varphi, i) = 1000 \times \sigma\Bigl(\frac{\pi}{6}, \frac{\pi}{4}\Bigl) \\
  &= 1000 \times \num{2.490756e-15} = \num{2.490756e-12}
\end{aligned}$$

where we used the equatorial value of $\qty{6378}{km}$, for the Earth's radius,
$R$, as the distance of the building from the center of the planet.



## Aircraft effective exposed area

As from [@patera2008][^balistic_descent], we assume that reentring debris will
descend vertically, which allows to express the effective expose area,
$\varepsilon_i$, as

$$
\varepsilon_i = \frac{s_{a} a_{h} + s_{d_i} a_{v}}{s_{d_i}}
$$

where $s_{a}$ is the average aircraft speed, $s_{d_i}$ is the average fall speed
of the $i$-th debris object, $a_v$ area of the aircraft as viewed from above,
$a_h$ area of the aircraft as viewed from the from the front of the aircraft.

In our calculations we will use

* debris fall speed $s_{d} = \qty{145}{mph}$
* aircraft speed, $s_{a}$, equal to its cruise speed
* aircraft area as viewed from above, $a_v = W \times L$, where $W$ is the
  wingspan, and $L$ the length
* aircraft area as viewed from the front, $a_h = W \times H$, where $W$ is the
  wingspan, and $H$ the height

The values to use have been retrieved from [@performance_database;@skybrary;@doc8643].

[^balistic_descent]: *Even for a ballistic coefficient of 50 lbs/ft2, the flight
path angle of a reentering object at 40,000 feet is -86.6 degrees, which
corresponds to nearly vertical descent.
Since most debris objects have ballistic coefficients equal to or 
less than 50 lbs/ft2, the vertical descent assumption is a very
accurate approximation.*




## Weighting function

::: {#fig-weighting}

```{r weighting}
#| out-width: "100%"
#| echo: false
knitr::include_graphics("media/figures/weighting.png")
```

Weighting function derived from 25 years of reentries. 
:::


# Data

::: {#fig-data-densities}

```{r densities}
#| out-width: "100%"
#| echo: false
knitr::include_graphics("media/figures/cubes.png")
```

Data cube of hourly flight densities data over H3 hexes (in Germany as an example) for multiple dates, $d_1 \cdots d_n$. 
:::


# Conclusion / Outcome

We show how National and/or International authorities could prepare for the more and more likely and frequent occurrence of uncontrolled reentry of space objects that could pose a safety concern on civilian aviation.
The techniques we implemented on realistic data and sound algorithms can contribute to the bag of tools in the hands of technical and political entities aiming at guaranteeing the utmost safety and minimal economic disruption to civil aviation in Europe.


# Appendix {.appendix}

## Orbital Elements {#sec-orbitals .appendix}
We refer to @fig-orbital-elements to describe the orbital parameters of
interest for the current work.

:::{#fig-orbital-elements layout="[40,-3,57]" fig-env="figure*"}

![Keplerian elements: semi-major axis, $a$, the eccentricity, $e = \frac{2c}{2a}$. (the semiparameter (a.k.a. _semilatus rectum_), $p$, describes the size of the conic section by defining the width at the primary focus, and is defined as
$p = b^2 / a = a (1 - e^2)$)](media/figures/classical_orbital_elements_2.png)

![Keplerian elements: inclination, $i$, the right ascension of the ascending node, $\Omega$ , and the argument of periapsis, $\omega$.(Earth rotates around $\hat{K}$)](media/figures/classical_orbital_elements_4.png)

Definition of Keplerian elements. The orbital elements describing the trajectory of orbiting object are illustrated in association with an inertial reference frame $\hat{I}$-$\hat{J}$-$\hat{K}$. The $I$-axis, $\hat{I}$, points toward the vernal equinox and the $J$-axis, $\hat{J}$, is perpendicular to the $I$-axis in the equatorial plane n the sense of Earth's rotation with the $K$-axis pointing up. The semi-major axis, $a$, the eccentricity, $e$, the inclination, $i$, the right ascension of the ascending node, $\Omega$ , and the argument of perigee, $\omega$, constitute, together with the mean anomaly at the initial position, $M_0$, a set of six constants of motion that are preserved in the absence of perturbation. True anomaly, $\nu$, specifies the location of an orbiting object within the orbit. It is the angle between perigee and the orbiting object’s position vector measured in the direction of the orbiting object’s motion.
Figures from [@sellers2003understanding], respectively Figure 5-2 and Figure 5-9.

:::

The angular position, $\theta$, of the reentry point from the ascending node
in the orbit plane is $\theta = \omega + \nu$.
It is related to the latitude, $\varphi$, via the Cartesian coordinate $k$,
$k = R \sin(\varphi) = R \sin(\theta)\sin(i)$, or

$$\sin(\varphi) = \sin(\theta)\sin(i)$$ {#eq-spheric-coords}

Mass of Earth, $M_{\oplus} = \qty{5.9722e24}{kg}$.



# References {.unnumbered}

::: {#refs}
:::
